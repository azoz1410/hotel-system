{
  "rules": {
    "rooms": {
      ".read": true,
      ".write": "auth != null",
      "$roomNumber": {
        "status": {
          ".write": "newData.val() == 'occupied' || newData.val() == 'available' || auth != null"
        }
      },
      ".indexOn": ["status", "type", "number"]
    },
    "bookings": {
      ".read": "auth != null",
      ".write": true,
      "$bookingId": {
        ".validate": "newData.hasChildren(['roomNumber', 'customerName', 'customerPhone', 'nationalId', 'checkIn', 'checkOut', 'totalPrice', 'status', 'createdAt'])",
        "roomNumber": {
          ".validate": "newData.isNumber()"
        },
        "customerName": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "customerPhone": {
          ".validate": "newData.isString() && newData.val().matches(/^05[0-9]{8}$/)"
        },
        "nationalId": {
          ".validate": "newData.isString() && newData.val().matches(/^[12][0-9]{9}$/)"
        },
        "checkIn": {
          ".validate": "newData.isString()"
        },
        "checkOut": {
          ".validate": "newData.isString()"
        },
        "totalPrice": {
          ".validate": "newData.isNumber() && newData.val() > 0"
        },
        "status": {
          ".validate": "newData.isString() && (newData.val() == 'pending' || newData.val() == 'confirmed' || newData.val() == 'cancelled' || newData.val() == 'completed')"
        }
      },
      ".indexOn": ["roomNumber", "status", "checkIn", "checkOut"]
    },
    "customers": {
      ".read": "auth != null",
      ".write": true,
      "$customerId": {
        ".validate": "newData.hasChildren(['name', 'phone', 'email'])",
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "phone": {
          ".validate": "newData.isString() && newData.val().matches(/^05[0-9]{8}$/)"
        },
        "email": {
          ".validate": "newData.isString()"
        }
      },
      ".indexOn": ["phone", "email"]
    },
    "logs": {
      ".read": "auth != null",
      ".write": true,
      "$logId": {
        ".validate": "newData.hasChildren(['action', 'timestamp'])"
      },
      ".indexOn": ["timestamp", "action"]
    },
    "stats": {
      ".read": true,
      ".write": "auth != null"
    },
    "settings": {
      ".read": true,
      ".write": "auth != null",
      "theme": {
        ".validate": "newData.isString() && (newData.val() == 'default' || newData.val() == 'dark' || newData.val() == 'ocean' || newData.val() == 'professional')"
      }
    }
  }
}
